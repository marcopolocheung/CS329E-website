
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <link rel="stylesheet" href="./weather-portal/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <style type="text/css">

/* Style the form */
#regForm {
  background-color: #ffffff;
  margin: 100px auto;
  padding: 40px;
  width: 70%;
  min-width: 300px;
}

/* Style the input fields */
.input {
  padding: 10px;
  width: 50%;
  font-size: 17px;
  font-family: Raleway;
  border: 1px solid #aaaaaa;
  margin: 5px;
}

/* Mark input boxes that gets an error on validation: */
input.invalid {
  background-color: #ffdddd;
}

  </style>

  <script src="./weather-portal/jquery-3.4.1.slim.min.js.download" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <script src="./weather-portal/popper.min.js.download" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="./weather-portal/bootstrap.min.js.download" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script src="./weather-portal/chart.js.download"></script>
  <script type="text/javascript">
    
    var cities = {}

    function store_city(event) {
      if (event) event.preventDefault();
      weather_parameters = [];
      city_name = document.getElementById("city_name").value;

      //ASSIGNMENT1 ADDITION
      if (!city_name || city_name.trim() === "") {
        alert("City name cannot be empty or contain only spaces.");
        return;
      }
      
      year = document.getElementById("year").value;
      var yearRegEx = /^\d{4}$/;
      y_format = year.match(yearRegEx);
      if (!y_format) {
        alert("Year should contain 4 digits.");
        return;
      }

      //ASSIGNMENT1 ADDITION
      month = document.getElementById("month").value;
            
      var monthRegEx = /^\d{2}$/;
      m_format = month.match(monthRegEx);
      if (!m_format) {
          alert("Month should be in following format: 01 - 12");
          return;
      }

      var monthNum = parseInt(month);
      if (monthNum < 1 || monthNum > 12) {
          alert("Month should be in following format: 01 - 12");
          return;
      }

      //ASSIGNMENT1 ADDITION
      if (document.querySelector('input[name="max_temp"]:checked')) {
          weather_parameters.push(document.getElementById("max_temp").value);
      }
      if (document.querySelector('input[name="min_temp"]:checked')) {
          weather_parameters.push(document.getElementById("min_temp").value);
      }
      if (document.querySelector('input[name="precipitation"]:checked')) {
          weather_parameters.push(document.getElementById("precipitation").value);
      }
      if (document.querySelector('input[name="snow"]:checked')) {
          weather_parameters.push(document.getElementById("snow").value);
      }

      //ASSIGNMENT1 ADDITION
      if (weather_parameters.length === 0) {
          alert("Please select at least one weather parameter.");
          return;
      }

      city_details = {};
      city_details['year'] = year;
      //ASSIGNMENT1 ADDITION
      city_details['month'] = month;
      city_details['weather_parameters'] = weather_parameters;

      cities[city_name] = city_details;

      //ASSIGNMENT1 ADDITION
      city = document.createElement("li");
      city.setAttribute("id", city_name + "-li");
      city_link = document.createElement("a");
      city_link.setAttribute("href", "#");
      city_link.setAttribute("onclick", "show_city('" + city_name + "'); return false;");
      city_link.style.cursor = "pointer";
      city_link.innerHTML = city_name;
      city.appendChild(city_link);
      document.getElementById("city_list").appendChild(city);
    }

    function show_city(city_name) {
      var city = cities[city_name];
      var details = "City details - " + city_name + "\n";
      details += "Year: " + city.year + "\n";
      details += "Month: " + city.month + "\n";
      details += "Weather Parameters: " + city.weather_parameters.join(", ");
      alert(details);
    }

    function show_settings() {
       alert("Settings called.");
    }

    function logout() {
      alert("Logout called.");
    }

    function display_new_run_form() {
      newRunFormDiv = document.getElementById("newRunFormDiv");
      newRunFormDiv.setAttribute("style", "display:block;");

      statusDiv = document.getElementById("status");
      statusDiv.setAttribute("style", "display:none;");
  }
  </script>

</head>
	<body>
		<div class="container-fluid" style="background-color:transparent">
		      <div class="row">
        		<div class="col">
          			<div class="text-left">
            				<a href="https://github.com/marcopolocheung/CS329E-website" target="_blank">MWA</a>
          			</div>
        		</div>
        		<div><h5 style="margin-top:5px;">Personal Weather Portal </h5></div>
        		<div class="col text-right">
          			<div class="dropdown">
            				<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">  testuser
              				<span class="caret"></span>
            				</button>
            				<ul class="dropdown-menu text-center" aria-labelledby="dropdownMenu1">
            				  <li><a href="https://github.com/marcopolocheung/CS329E-website" onclick="show_settings()">Settings</a></li>
             				  <li><hr class="dropdown-divider"></li>
              				  <li><a href="https://github.com/marcopolocheung/CS329E-website" onclick="logout()">Logout</a></li>
            				</ul>
          			</div>
        			</div>
      			</div>
		</div>
		<hr>

		<div class="container-fluid">
		<div class="row  mvh-100 flex-column flex-md-row">
        	<div class="col-md-2 div_left" style="height:90vh;background-color: lightblue;float:left; margin-top:-16px;">
			<div class="row" id="newrun">
				<button onclick="display_new_run_form()" style="margin-left:5px;margin-top:5px">Register City</button>
			</div>
			<hr>
      <div class="row"> <!-- row2 -->
			<div>
			              <ul id="city_list">
              			</ul>
			</div>
          		</div> <!-- row2 -->
		</div>

    <div class="col-md-10 flex-grow-1 div_right" id="entity-form-container">

      <div id="status">
        <div id="status_string"></div>
        <div id="outputImg"></div>
      </div>

      <div id="newRunFormDiv">
		<!-- <form id="regForm" action="" style="margin-top:-10px;"> -->

		<label>City Name</label>
		<input class="input" type="text" placeholder="City Name" name="city_name" id="city_name" required="">
		<br><br>
		<br><br>
		<div class="tab1"><b style="color:blue;">Inputs:</b>
			<table>
			<tbody><tr>
				<td><label>Year</label></td>
				<td><input class="input" type="text" placeholder="YYYY" name="year" id="year" style="width:125%" required=""></td>
      </tr>
      <tr>
        <td><label>Month</label></td>
        <td><input class="input" type="text" placeholder="MM" name="month" id="month" style="width:125%" required=""></td>
      </tr>

	     <tr>
        <td><label class="label">Weather Parameters</label></td>
			</tr>
			<tr>
				<td></td>
        <td>
            <!--ASSIGNMENT1 ADDITION-->
            <input type="checkbox" name="max_temp" id="max_temp" value="max_temp">Max Temperature<br><br>
            <input type="checkbox" name="min_temp" id="min_temp" value="min_temp">Min Temperature<br><br>
            <input type="checkbox" name="precipitation" id="precipitation" value="precipitation">Precipitation<br><br>
            <input type="checkbox" name="snow" id="snow" value="snow">Snow<br><br>
        </td>
      </tr>

			</tbody></table>
  <button type="submit" onclick="store_city()" class="btn btn-primary">Submit</button>
		</div>

		<!-- </form> -->
		</div>
		</div>
		</div>

  		<script src="./weather-portal/inputhandler.js.download"></script>

</div></body></html>